<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <title>信息维护【在线音乐推荐系统】</title>
    {% include '../common/css.html' %}
    <link rel="stylesheet" type="text/css" href="{% static 'webuploader-0.1.5/webuploader.css' %}">
</head>
<body class="sticky-header left-side-collapsed" style="">
	<section>
		<div class="main-content" style="margin-left:0px;padding-top:0px">
			{% include '../common/header.html' %}
			<div id="page-wrapper">
				<div class="inner-content" align="center">
					<div class="music-left" style="float:none;">
						<div class="albums">
							{% include '../common/menu.html' %}
							<div class="col-md-3" style="width:74%;text-align: left">
								<form action="/user/doEdit" method="post" class="form-horizontal" id="form" enctype="multipart/form-data">
									{% csrf_token %}
                                    <div class="form-group">
						                <label for="inputEmail" class="col-sm-2 col-md-2 control-label" style="width:25%">用户名：</label>
						                <div class="col-sm-6 col-md-6">
						                    <input type="text" name="username" class="form-control" value="{{ user.username }}"
                                                   maxlength="255" readonly="readonly"/>
						                </div>
						            </div><div class="clearfix"> </div>
						            <div class="form-group">
						                <label for="inputEmail" class="col-sm-2 col-md-2 control-label" style="width:25%">邮箱：</label>
						                <div class="col-sm-6 col-md-6">
						                    <input type="text" class="form-control" name="email" id="email" maxlength="255" value="{{ user.email }}"/>
						                </div>
						            </div><div class="clearfix"> </div>
									<div class="form-group">
						                <label for="address" class="col-sm-2 col-md-2 control-label" style="width:25%">头像：</label>
						                <div class="col-sm-6 col-md-6">
						                    <input name="header" type="hidden" id="header"
                                                                   value="{{ user.header }}" data-url="{{ user.header.url }}"/>
						                    <div id="uploader_header">
											    <!--用来存放文件信息-->
											    <div id="thelist_header" class="uploader-list"></div>
											    <div class="btns">
											        <div id="picker_header">选择图片</div>
											        <button id="ctlBtn_header" class="btn btn-default" type="button">开始上传</button>
											    </div>
											</div>
						                </div>
						            </div><div class="clearfix"> </div>
						            <div class="form-group" align="center">
										<div style="display:inline-block;" >
											<div class="btn btn-danger" id="submitBtn" style="color: #fff">提交信息</div>
										</div>
									</div>
								</form>
							</div>
						</div><div class="clearfix"> </div>
					</div>
				</div>
			</div>
		</div>
		{% include '../common/footer.html' %}
	</section>
    {% include '../common/js.html' %}
	<script type="text/javascript" src="{% static 'webuploader-0.1.5/webuploader.min.js' %}"></script>
  	<script type="text/javascript" src="{% static 'js/uploadfile.js' %}"></script>
</body>
<script>
	$(function(){
		uploadImage("/upload","header","{{ csrf_token }}");

		$("#submitBtn").on("click",function(){
				var temp = true;
				$("#form").find("input[type='text']").each(function(){
					if($(this).val()==null || $(this).val()==""){
						temp = false;
						return false;
					}
				});
				if(!temp){
					layer.msg("数据不能为空!");return false;
				}
				//对电子邮件的验证
                var emailreg = /^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;
                if(!emailreg.test($("#email").val())){
                    layer.msg("邮箱格式不正确!");return false;
                }
				if($("#header").val()==null || $("#header").val()==""){
					layer.msg("请上传图片!");return false;
				}
				common_ajax_other($("#form").attr("action"),$("#form").serialize());
		});
	});
</script>
</html>
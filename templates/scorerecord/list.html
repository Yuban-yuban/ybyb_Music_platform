<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <title>评分记录【在线音乐推荐系统】</title>
    {% include '../common/css.html' %}
    <style>
        .cleanfloat::after {
            display: block;
            content: "";
            visibility: hidden;
            height: 0;
        }
        .score ul li {
            list-style: none;
            display: inline-block;
            color: #ccc;
            cursor: pointer;
            font-size: 20px;
        }
        .layui-layer-rim{
            text-align:center;
            line-height:180px;
            font-size:14px
        }
    </style>
</head>
<body class="sticky-header left-side-collapsed" style="">
	<section>
		<div class="main-content" style="margin-left:0px;padding-top:0px">
			{% include '../common/header.html' %}
			<div id="page-wrapper">
				<div class="inner-content" align="center">
					<div class="music-left" style="float:none;">
						<div class="albums">
							{% include '../common/menu.html' %}
							<div class="col-md-3" style="width:74%;text-align: left">
                                <div class="bs-docs-example" style="color:black;">
									<table class="table table-bordered" id="scoreTable">
									    <thead >
										    <tr style="text-align: center;">
										        <th>序号</th>
										        <th>音乐名称</th>
										        <th>评分时间</th>
										        <th>操作</th>
										    </tr>
									    </thead>
									    <tbody>
                                            {% if not pageBean %}
                                                <tr><td colspan="4"><font style="color:black">暂无数据</font></td><tr>
                                            {% endif %}
                                            {% for scorerecord in pageBean %}
												<tr>
												    <td>{{ forloop.counter }}</td>
												    <td>
                                                        <a href="/music/detail?musicid={{ scorerecord.musicid.id }}">
                                                            {{ scorerecord.musicid.musicname }}
                                                        </a>
                                                    </td>
												    <td>{{ scorerecord.createtime }}</td>
												    <td class="score">
                                                        <ul data-score="{{ scorerecord.score }}"
                                                            data-musicid="{{ scorerecord.musicid.id }}"
                                                            class="cleanfloat" style="display: inline-block;padding:0px">
                                                            <li title="1分" data-info="1">&#9733;</li><li title="2分" data-info="2" >&#9733;</li><li title="3分" data-info="3" >&#9733;</li><li title="4分" data-info="4" >&#9733;</li><li title="5分" data-info="5" >&#9733;</li>
                                                        </ul>
												  </td>
												</tr>
                                            {% endfor %}
									    </tbody>
									</table>
						  		</div>
								<div class="clearfix"> </div>
								<form action="/scorerecord/list" method="post" id="form">
		    		  				{% csrf_token %}
    		  				        <input type="hidden" name="page" value="{{ page }}" id="page">
		    		  			</form>
                                {% include '../common/page.html' %}
							</div>
						</div><div class="clearfix"> </div>
					</div>
				</div>
			</div>
		</div>
		{% include '../common/footer.html' %}
	</section>
    {% include '../common/js.html' %}
</body>
<script>
	//评分
	$("#scoreTable").find("ul").each(function(){
		var scoreTemp = $(this).data("score");
		var countTemp = 0;
		$(this).find("li").each(function(){
			if(countTemp<scoreTemp){
				$(this).css("color", '#f00');
				countTemp++;
			}
		});
	});

	$("#scoreTable").find("ul").each(function(){
		$(this).find("li").click(function() {
			if(doIsLogin()){
				var musicid = $(this).parent().data("musicid");
				var data = "musicid="+musicid+"&score="+$(this).attr("data-info")+
                    "&csrfmiddlewaretoken={{ csrf_token }}";
				common_ajax_other("/scorerecord/save",data);
			}
		});
	});
	//评分
</script>
</html>